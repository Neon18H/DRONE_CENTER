{% extends "base_login.html" %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container-fluid min-vh-100 d-flex align-items-center login-command-wrapper">
  <div class="row w-100 justify-content-center align-items-center">
    <div class="col-lg-3 d-none d-lg-flex flex-column hud-sidebar">
      <div class="hud-block">
        <div class="hud-label">System Status</div>
        <div class="hud-value">ONLINE</div>
      </div>
      <div class="hud-block">
        <div class="hud-label">Global Sectors</div>
        <div class="hud-value">ACTIVE</div>
      </div>
      <div class="hud-block">
        <div class="hud-label">Encryption</div>
        <div class="hud-value">AES-256</div>
      </div>
      <div class="hud-block">
        <div class="hud-label">Link</div>
        <div class="hud-value">SECURE</div>
      </div>
      <div class="hud-telemetry">
        <span>COORD: 04.7110N / 74.0721W</span>
        <span>UPLINK: STABLE</span>
        <span>SECTOR: A-17</span>
        <span>GRID: ACTIVE</span>
        <span>SYNC: 99.98%</span>
      </div>
    </div>

    <div class="col-12 col-sm-10 col-md-8 col-lg-5">
      <div class="login-panel">
        <div class="login-header">
          <div>
            <div class="login-logo">DRONEX</div>
            <div class="login-subtitle">Unified Drone Command Center</div>
          </div>
          <span class="login-badge">Secure Access</span>
        </div>

        {% if form.non_field_errors %}
          <div class="login-alert" role="alert">
            <strong>⚠ ACCESS DENIED</strong>
            <div>{{ form.non_field_errors }}</div>
          </div>
        {% endif %}

        {% if messages %}
          {% for message in messages %}
            <div class="login-alert" role="alert">
              <strong>⚠ INVALID CREDENTIALS</strong>
              <div>{{ message }}</div>
            </div>
          {% endfor %}
        {% endif %}

        <form method="post" novalidate>
          {% csrf_token %}
          {{ form|crispy }}
          <button type="submit" class="btn login-submit w-100">Authenticate</button>
        </form>

        {% url 'password_reset' as password_reset_url %}
        {% if password_reset_url %}
          <div class="login-links">
            <a href="{{ password_reset_url }}" class="login-link">Forgot password?</a>
          </div>
        {% endif %}
      </div>
      <div class="login-footer">
        <span>Unauthorized access is prohibited</span>
        <span class="login-timestamp" id="login-timestamp"></span>
      </div>
      <div class="status-ticker">
        <div class="ticker-track">
          <span>Status: Auth Gate Ready</span>
          <span>Biometrics: Standby</span>
          <span>Core Sync: 99.98%</span>
          <span>Status: Auth Gate Ready</span>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  const loginTimestamp = document.getElementById("login-timestamp");
  const updateTimestamp = () => {
    const now = new Date();
    loginTimestamp.textContent = now.toLocaleString("es-CO", {
      year: "numeric",
      month: "2-digit",
      day: "2-digit",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit",
    });
  };
  updateTimestamp();
  setInterval(updateTimestamp, 1000);
</script>
{% endblock %}
